<!doctype html>
<html lang="en">
    <head>
        <title>three.js webgl - loaders - vtk loader</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body {
                background-color: #000;
                color: #fff;
                margin: 0px;
                overflow: hidden;
            }
            div#threeDview {
                width:100%;
                height:100%;
            }
        </style>
        <script src="resources/js/Three.js"></script>
        <script src="resources/js/surfload.js"></script>
        <script src='resources/js/jquery-1.7.2.min.js'></script>
        <script type="x-shader/x-vertex" id="vertexshader">
            uniform float fidwt;
            uniform float pts1wt;
            uniform float flatwt;

            attribute float pts1;
            attribute float flat;

            varying vec3 vNormal;

            void main() {
                vNormal = normal;

                vec3 newPosition = fidwt*position + pts1wt*pts1 + flatwt*flat;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
            }
        </script>
        <script type="x-shader/x-fragment" id="fragmentshader">
            varying vec3 vNormal;

            void main() {
                vec3 light = vec3( 0.5, 0.2, 1.0 );
                light = normalize( light );

                float dProd = dot( vNormal, light ) * 0.5 + 0.5;

                vec3 color = vec3(0.5, 0.5, 0.5);
                gl_FragColor = vec4( vec3( dProd ) * vec3( color ), 1.0 );

            }
        </script>
        <script type='text/javascript'>
        function init() {
            // scene and camera
            var scene = new THREE.Scene();

            var camera = new THREE.PerspectiveCamera( 60, window.innerWidth / window.innerHeight, 0.01, 1e5 );
            camera.position.x = 200;
            camera.position.y = 200;
            camera.position.z = 0;

            scene.add( camera );

            var controls = new THREE.TrackballControls( camera );

            controls.rotateSpeed = 5.0;
            controls.zoomSpeed = 20;
            controls.panSpeed = 2;

            controls.noZoom = false;
            controls.noPan = false;

            controls.staticMoving = true;
            controls.dynamicDampingFactor = 0.3;

            // renderer
            var renderer = new THREE.WebGLRenderer( { antialias: false } );
            renderer.setClearColorHex( 0x000000, 1 );
            renderer.setSize( window.innerWidth, window.innerHeight );

            container = document.createElement( 'div' );
            document.body.appendChild( container );
            container.appendChild( renderer.domElement );

            var material =  new THREE.MeshLambertMaterial( { color:0xffffff} );

            var loader=new THREE.BinSurfLoader();
            loader.load ("/surfaces/AH/", function(data){
                var geom = data['geometry'];
                var attrib = data['attributes'];

                var mesh = new THREE.Mesh(geom , material);
                mesh.doubleSided=true;
                mesh.position.setY(-0.09);
                scene.add( mesh );
                animate();
            });

            function animate() {
                requestAnimationFrame( animate );
                controls.update();
                renderer.render( scene, camera );
            }
        }
        </script>
    </head>
    
    <body>
        <div id='threeDview'>
        </div>
        <input type="range" min="0" max="1", value="1"><input type='text' value='1'>
    </body>
</html>
