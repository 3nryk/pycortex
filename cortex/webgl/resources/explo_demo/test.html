<!doctype html>
<style type="text/css">
body {
	background:gray;
	text-align:center;
	font-family:Helvetica;
}
#gestures {
	color:white;
	position:absolute;
	left:50%;
	top:50%;
	width:965px;
	margin-left:-482.5px;
	margin-top:-420px;
	border:1px solid white;
}
#gestures p:first-child {
	font-size:24px;
	text-align:center;
}
#gestures img {
	width:965px;
	height:750px;
	float:left;
}
#gestures #gesture_1 {
	margin-bottom:-750px;
}
#gestures p:last-child{
	font-size:18pt;
	text-align:center;
	clear:left;
}
</style>
<div id="gestures">
	<p>Explore the brain activity of someone watching this video</p>
	<img id="gesture_1" />
	<img id="gesture_2" />
	<p id="gesture_name">Rotate</p>
</div>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/ui/1.11.2/jquery-ui.min.js"></script>
<script type='text/javascript'>

function Gesture(info) {
	this.active = false;
	this.info = info;
	this.imgs = [];
	for (var i = 0; i < info.names.length; i++) {
		var im1 = new Image();
		im1.src = info.names[i]+"_1.svg";
		var im2 = new Image();
		im2.src = info.names[i]+"_2.svg";
		this.imgs.push([im1, im2]);
	}
}
Gesture.prototype.show = function() {
	this.idx = 0;
	this.frame = 0;
	this.active = true;
	this.update();
	this.promise = $.Deferred();
	return this.promise;
}
Gesture.prototype.update = function() {
	if (this.active) {
		$("#gesture_name").text(this.info.names[this.idx]);
		$("#gesture_1").attr("src", this.imgs[this.idx][0].src);
		$("#gesture_2").attr("src", this.imgs[this.idx][1].src);

		if (this.frame % 2 == 0) {
			$("#gesture_1").fadeIn({duration:this.info.speed[this.idx], easing:"easeInOutQuint"});
			$("#gesture_2").fadeOut({duration:this.info.speed[this.idx], easing:"easeInOutQuint", complete:this.update.bind(this)});
		} else {
			$("#gesture_2").fadeIn({duration:this.info.speed[this.idx], easing:"easeInOutQuint"});
			$("#gesture_1").fadeOut({duration:this.info.speed[this.idx], easing:"easeInOutQuint", complete:this.update.bind(this)});
		}

		if (this.frame / 2 > this.info.reps[this.idx]) {
			this.frame = 0;
			this.idx += 1;
			if (this.idx >= this.info.names.length) {
				this.active = false;
				this.promise.resolve();
			}
		} else
			this.frame += 1;
	}
}
Gesture.prototype.stop = function() {
	this.active = false;
	$("#gesture").fadeOut();
}

var gesture = new Gesture({reps:[2, 1, 2], names:["rotate", "flatten", "zoom"], speed:[1000, 1500, 750]});
gesture.show();
</script>
